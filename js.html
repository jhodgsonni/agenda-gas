<script>

function crearTablaContactos()
{
    let tabla = document.getElementById('tablaContactos');//obtiene la tabla si ya existe
    if(tabla)
    {
        tabla.remove();//si existe la tabla la elimina, para que no se duplique
    }
    //Hace la tabla hasta que la funcion obtenerContactos termine
    google.script.run.withSuccessHandler( 
        function(obj)//obj es el resultado de la funcion obtenerContactos
        {
           
            //creamos la tabla
            tabla = document.createElement('table');
            tabla.id = 'tablaContactos';

            let tablaHeader = document.createElement('thead');
            let tablaBody = document.createElement('tbody');

            //Empezamos creando el header de la tabla
            let primeraFila = document.createElement('tr');//creamos una fila

            for(let i=0; i<obj[0].length; i++)//saca los elementos de la cabezera
            {
                let celda = document.createElement('td');//creamos una celda por cada elemento de la matriz de excel
                    celda.textContent = obj[0][i];
                    primeraFila.appendChild(celda);//agregamos la celda a la fila pero en la pagina web
            }
            //si es la primera fila, la agregamos a la cabecera
            tablaHeader.appendChild(primeraFila);
            tabla.appendChild(tablaHeader);

            //Aqui empezamos a crear el cuerpo de la tabla
            for(let i=1; i< obj.length; i++)
            {
                let fila = document.createElement('tr');//creamos una fila
                for(let j=0; j< obj[i].length; j++)
                {
                    let celda = document.createElement('td');//creamos una celda por cada elemento de la matriz de excel
                    celda.textContent = obj[i][j];
                    fila.appendChild(celda);//agregamos la celda a la fila pero en la pagina web
                }
                    tablaBody.appendChild(fila);//agregamos la fila a la tabla pero en la pagina web
            }

            //Array.from(obj).forEach((filaActual,i) =>
            //{
            //    let fila = document.createElement('tr');
            //    filaActual.forEach(celdaActual =>
            //    {
            //        let celda = document.createElement('td');
            //        celda.textContent = celdaActual;
            //        fila.appendChild(celda);
            //    });
            //    if(i==0)
            //    {    
            //        tablaHeader.appendChild(fila);
            //        tabla.appendChild(tablaHeader);
            //    }
            //    else
            //    {
            //        tablaBody.appendChild(fila);
            //    }    
            //});
            
            
            //agregamos clases a la cabecera
            tablaHeader.classList.add('table-dark');
            //agregamos el cuerpo de la tabla
            tabla.appendChild(tablaBody);
            //agregamos clases a la tabla
            tabla.classList.add('table', 'table-striped', 'border', 'border-3');
            //agrega,la tabla a la pagina
            document.getElementById('divContactos').appendChild(tabla);//divContactos es el id del div que esta en Main.html
        }
    ).obtenerContactos();
}    
</script>